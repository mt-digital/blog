<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matthew A. Turner">
<meta name="dcterms.date" content="2024-08-12">

<title>MA Turner, PhD - Why a rigorous understanding of collective adaptation?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MA Turner, PhD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../static/turner_cv.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mt-digital"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/MATurnerPhD"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://linkedin.com/in/maturner01"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">RUCA Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Why a rigorous understanding of collective adaptation?</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">news</div>
                <div class="quarto-category">review</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Matthew A. Turner </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 12, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Our world faces threats of climate change, ecosystem loss, pandemics, political and social instability, and more. We humans are challenged to respond with adaptations that mitigate or prevent greater catastrophe <span class="citation" data-cites="PisorLansingMagargal2023 Currie2024">(<a href="#ref-PisorLansingMagargal2023" role="doc-biblioref">Pisor, Lansing, and Magargal 2023</a>; <a href="#ref-Currie2024" role="doc-biblioref">Currie et al. 2024</a>)</span>. Collective adaptation is an emergent phenomena composed of constituent sub-processes occurring across several time, population, and geographic/spatial scales: from milliseconds to millenia; from an individual to dyads to the global metapopulation; and from micrometers-long neurons to global-scale communication networks <span class="citation" data-cites="GalesicEtAl2023">(<a href="#ref-GalesicEtAl2023" role="doc-biblioref">Galesic et al. 2023</a>)</span>. If we can develop a rigorous understanding of how collective adaptation works, we may be better able to optimize “stewardship of global collective behavior” <span class="citation" data-cites="Bak-Coleman2021">(<a href="#ref-Bak-Coleman2021" role="doc-biblioref">Bak-Coleman et al. 2021</a>)</span>. Modern stewardship of collective behavior at all population scales needs the scientific, rigorous understanding of collective adaptation we contribute to in the RUCA project.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Sketch of collective human and non-human collective adaptation. Novel technologies and threats both emerge from human cultural evolution. Pandemic-causing pathogens, biodiversity, and human culture all co-evolve on commensurate time scales.</figcaption>
</figure>
</div>
<p>Non-human populations, from viruses to whales, also co-adapt and co-evolve. Pathogen evolution is important cases due to the risk of disease outbreaks when pathogens spill over from non-human animals (e.g., birds, bats, pigs) to humans. Spillovers are increasingly common in the new epoch of rapid global change <span class="citation" data-cites="Baker2022">(<a href="#ref-Baker2022" role="doc-biblioref">Baker et al. 2022</a>)</span>. In spillovers, pathogens are initially poorly adapted to their new human hosts, but can rescue themselves through evolution <span class="citation" data-cites="Visher2021">(<a href="#ref-Visher2021" role="doc-biblioref">Visher et al. 2021</a>)</span>. Pathogen evolution is sensitive to metapopulation group structure <span class="citation" data-cites="Best2011">(<a href="#ref-Best2011" role="doc-biblioref">Best et al. 2011</a>)</span>, and therefore pathogen evolution may be sensitive to changes in human group size, asymmetric homophily levels, out-group aversion, and rising extremism and polarization. If we could predict which groups are most likely to get infected, and which individuals are best to target for intervention towards pandemic preparedness behaviors (such as getting vaccinated), we could more efficiently use available resources.</p>
<p>Beyond applications to critical problems, collective adaptation theory can be used to better understand culture in other species, for example whales who collectively generate, through transmission and modulation, a cumulative cultural repertoire of whale songs <span class="citation" data-cites="Garland2022">(<a href="#ref-Garland2022" role="doc-biblioref">Garland, Garrigue, and Noad 2022</a>)</span>.</p>
<section id="the-ruca-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-ruca-approach">The RUCA approach</h2>
<p>Rigor takes time, following a step-wise approach to understand which parts of a system interact, and how, to cause the emergence of higher-order processes constituted by those interactions. This is known as <em>mechanistic modeling</em> <span class="citation" data-cites="Turner2022">(<a href="#ref-Turner2022" role="doc-biblioref">Matthew A. Turner and Smaldino 2022</a>)</span>. Mechanistic models are useful for emergent phenomena such as collective adaptation because they force experimenters to explicitly state what are the component parts of their system of interest <span class="citation" data-cites="Kauffman1970">(<a href="#ref-Kauffman1970" role="doc-biblioref">Kauffman 1970</a>)</span> and how do they interact to produce some process composed of numerous such interactions <span class="citation" data-cites="Craver2006">(<a href="#ref-Craver2006" role="doc-biblioref">Craver 2006</a>)</span>. My work develops mechanistic models that synthesize, connect, and clarify diverse adaptive and social processes and understand the sometimes unexpected consequences of the interaction of these processes and the environment <span class="citation" data-cites="Turner2018 Turner2020 Turner2023a Turner2023">(<a href="#ref-Turner2018" role="doc-biblioref">Matthew A. Turner and Smaldino 2018</a>; <a href="#ref-Turner2020" role="doc-biblioref">Matthew A. Turner and Smaldino 2020</a>; <a href="#ref-Turner2023a" role="doc-biblioref">Matthew A. Turner et al. 2023a</a>; <a href="#ref-Turner2023" role="doc-biblioref">Matthew A. Turner et al. 2023b</a>)</span>.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bak-Coleman2021" class="csl-entry" role="listitem">
Bak-Coleman, Joseph B., Mark Alfano, Wolfram Barfuss, Carl T. Bergstrom, Miguel A. Centeno, Iain D. Couzin, Jonathan F. Donges, et al. 2021. <span>“<span class="nocase">Stewardship of global collective behavior</span>.”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 118 (27): 1–10. <a href="https://doi.org/10.1073/pnas.2025764118">https://doi.org/10.1073/pnas.2025764118</a>.
</div>
<div id="ref-Baker2022" class="csl-entry" role="listitem">
Baker, Rachel E., Ayesha S. Mahmud, Ian F. Miller, Malavika Rajeev, Fidisoa Rasambainarivo, Benjamin L. Rice, Saki Takahashi, et al. 2022. <span>“<span class="nocase">Infectious disease in an era of global change</span>.”</span> <em>Nature Reviews Microbiology</em> 20 (4): 193–205. <a href="https://doi.org/10.1038/s41579-021-00639-z">https://doi.org/10.1038/s41579-021-00639-z</a>.
</div>
<div id="ref-Best2011" class="csl-entry" role="listitem">
Best, Alex, Steve Webb, Andy White, and Mike Boots. 2011. <span>“<span class="nocase">Host resistance and coevolution in spatially structured populations</span>.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 278 (1715): 2216–22. <a href="https://doi.org/10.1098/rspb.2010.1978">https://doi.org/10.1098/rspb.2010.1978</a>.
</div>
<div id="ref-Craver2006" class="csl-entry" role="listitem">
Craver, Carl F. 2006. <span>“<span class="nocase">When mechanistic models explain</span>.”</span> <em>Synthese</em> 153 (3): 355–76. <a href="https://doi.org/10.1007/s11229-006-9097-x">https://doi.org/10.1007/s11229-006-9097-x</a>.
</div>
<div id="ref-Currie2024" class="csl-entry" role="listitem">
Currie, Thomas E., Monique Borgerhoff Mulder, Laurel Fogarty, Maja Schlüter, Carl Folke, L. Jamila Haider, Guido Caniglia, et al. 2024. <span>“<span class="nocase">Integrating evolutionary theory and social-ecological systems research to address the sustainability challenges of the Anthropocene</span>.”</span> <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em> 379 (1893). <a href="https://doi.org/10.1098/rstb.2022.0262">https://doi.org/10.1098/rstb.2022.0262</a>.
</div>
<div id="ref-GalesicEtAl2023" class="csl-entry" role="listitem">
Galesic, Mirta, Daniel Barkoczi, Andrew M. Berdhal, Dora Biro, Giuseppe Carbone, Ilaria Giannoccaro, Robert L. Goldstone, et al. 2023. <span>“<span class="nocase">Beyond collective intelligence : Collective adaptation</span>.”</span> <em>Journal of the Royal Society Interface</em> 20 (20220736). <a href="https://doi.org/10.1098/rsif.2022.0736">https://doi.org/10.1098/rsif.2022.0736</a>.
</div>
<div id="ref-Garland2022" class="csl-entry" role="listitem">
Garland, Ellen C., Claire Garrigue, and Michael J. Noad. 2022. <span>“<span class="nocase">When does cultural evolution become cumulative culture? A case study of humpback whale song</span>.”</span> <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em> 377 (1843). <a href="https://doi.org/10.1098/rstb.2020.0313">https://doi.org/10.1098/rstb.2020.0313</a>.
</div>
<div id="ref-Kauffman1970" class="csl-entry" role="listitem">
Kauffman, Stuart A. 1970. <span>“<span class="nocase">Articulation of Parts Explanation in Biology and the Rational Search for Them</span>.”</span> In <em>PSA: Proceedings of the Biennial Meeting of the Philosophy of Science Association</em>, 257–72.
</div>
<div id="ref-PisorLansingMagargal2023" class="csl-entry" role="listitem">
Pisor, Anne, J. Stephen Lansing, and Kate Magargal. 2023. <span>“<span class="nocase">Climate change adaptation needs a science of culture</span>.”</span> <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em> 378 (1889). <a href="https://doi.org/10.1098/rstb.2022.0390">https://doi.org/10.1098/rstb.2022.0390</a>.
</div>
<div id="ref-Turner2023a" class="csl-entry" role="listitem">
Turner, Matthew A., Cristina Moya, Paul E. Smaldino, and James Holland Jones. 2023a. <span>“<span class="nocase">The form of uncertainty affects selection for social learning</span>.”</span> <em>Evolutionary Human Sciences</em> 5. <a href="https://doi.org/10.1017/ehs.2023.11">https://doi.org/10.1017/ehs.2023.11</a>.
</div>
<div id="ref-Turner2023" class="csl-entry" role="listitem">
Turner, Matthew A, Alyson L Singleton, Mallory J Harris, Ian Harryman, Cesar Augusto Lopez, Ronan Forde Arthur, Caroline Muraida, and James Holland Jones. 2023b. <span>“<span class="nocase">Minority-group incubators and majority-group reservoirs support the diffusion of climate change adaptations</span>.”</span>
</div>
<div id="ref-Turner2018" class="csl-entry" role="listitem">
Turner, Matthew A., and Paul E. Smaldino. 2018. <span>“<span class="nocase">Paths to Polarization: How Extreme Views, Miscommunication, and Random Chance Drive Opinion Dynamics</span>.”</span> <em>Complexity</em>. <a href="https://doi.org/10.1155/2018/2740959">https://doi.org/10.1155/2018/2740959</a>.
</div>
<div id="ref-Turner2022" class="csl-entry" role="listitem">
———. 2022. <span>“<span class="nocase">Mechanistic Modeling for the Masses - commentary on Yarkoni, "The generalizability crisis"</span>.”</span> <em>Behavioral and Brain Sciences</em> 45 (E33). <a href="https://doi.org/10.1017/S0140525X2100039X">https://doi.org/10.1017/S0140525X2100039X</a>.
</div>
<div id="ref-Turner2020" class="csl-entry" role="listitem">
Turner, Matthew A, and Paul E Smaldino. 2020. <span>“<span class="nocase">Stubborn extremism as a potential pathway to group polarization</span>.”</span> In <em>Proceedings of the Cognitive Science Society</em>. Toronto.
</div>
<div id="ref-Visher2021" class="csl-entry" role="listitem">
Visher, Elisa, Claire Evensen, Sarah Guth, Edith Lai, Marina Norfolk, Carly Rozins, Nina A. Sokolov, Melissa Sui, and Michael Boots. 2021. <span>“<span class="nocase">The three Ts of virulence evolution during zoonotic emergence</span>.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 288 (1956). <a href="https://doi.org/10.1098/rspb.2021.0900">https://doi.org/10.1098/rspb.2021.0900</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="mt-digital/mt.digital-blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>